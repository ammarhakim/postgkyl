def _expand_2d1p(f, x, y):
  return (
      1.5 * f[..., 3] * x * y
      + 0.8660254037844386 * f[..., 2] * y
      + 0.8660254037844386 * f[..., 1] * x
      + 0.5 * f[..., 0]
  )


# end


def _expand_2d2p(f, x, y):
  return (
      2.904737509655563 * f[..., 7] * (x * y**2 - 0.3333333333333333 * x)
      + 1.677050983124842 * f[..., 5] * (y**2 - 0.3333333333333333)
      + 2.904737509655563 * f[..., 6] * (x**2 * y - 0.3333333333333333 * y)
      + 1.5 * f[..., 3] * x * y
      + 0.8660254037844386 * f[..., 2] * y
      + 1.677050983124842 * f[..., 4] * (x**2 - 0.3333333333333333)
      + 0.8660254037844386 * f[..., 1] * x
      + 0.5 * f[..., 0]
  )


# end


def _expand_2d3p(f, x, y):
  return (
      5.7282196186948 * f[..., 11] * (x * y**3 - 0.6 * x * y)
      + 3.307189138830738 * f[..., 9] * (y**3 - 0.6 * y)
      + 2.904737509655563 * f[..., 7] * (x * y**2 - 0.3333333333333333 * x)
      + 1.677050983124842 * f[..., 5] * (y**2 - 0.3333333333333333)
      + 5.7282196186948 * f[..., 10] * (x**3 * y - 0.6 * x * y)
      + 2.904737509655563 * f[..., 6] * (x**2 * y - 0.3333333333333333 * y)
      + 1.5 * f[..., 3] * x * y
      + 0.8660254037844386 * f[..., 2] * y
      + 3.307189138830738 * f[..., 8] * (x**3 - 0.6 * x)
      + 1.677050983124842 * f[..., 4] * (x**2 - 0.3333333333333333)
      + 0.8660254037844386 * f[..., 1] * x
      + 0.5 * f[..., 0]
  )


# end


def _expand_2d4p(f, x, y):
  return (
      11.36658342467076
      * f[..., 16]
      * (x * y**4 - 0.8571428571428571 * (x * y**2 - 0.3333333333333333 * x) - 0.2 * x)
      + 6.5625
      * f[..., 14]
      * (y**4 - 0.8571428571428571 * (y**2 - 0.3333333333333333) - 0.2)
      + 5.7282196186948 * f[..., 12] * (x * y**3 - 0.6 * x * y)
      + 3.307189138830738 * f[..., 9] * (y**3 - 0.6 * y)
      + 5.625
      * f[..., 10]
      * (
          x**2 * y**2
          - 0.3333333333333333 * (y**2 - 0.3333333333333333)
          - 0.3333333333333333 * (x**2 - 0.3333333333333333)
          - 0.1111111111111111
      )
      + 2.904737509655563 * f[..., 7] * (x * y**2 - 0.3333333333333333 * x)
      + 1.677050983124842 * f[..., 5] * (y**2 - 0.3333333333333333)
      + 11.36658342467076
      * f[..., 15]
      * (-0.8571428571428571 * (x**2 * y - 0.3333333333333333 * y) + x**4 * y - 0.2 * y)
      + 5.7282196186948 * f[..., 11] * (x**3 * y - 0.6 * x * y)
      + 2.904737509655563 * f[..., 6] * (x**2 * y - 0.3333333333333333 * y)
      + 1.5 * f[..., 3] * x * y
      + 0.8660254037844386 * f[..., 2] * y
      + 6.5625
      * f[..., 13]
      * (x**4 - 0.8571428571428571 * (x**2 - 0.3333333333333333) - 0.2)
      + 3.307189138830738 * f[..., 8] * (x**3 - 0.6 * x)
      + 1.677050983124842 * f[..., 4] * (x**2 - 0.3333333333333333)
      + 0.8660254037844386 * f[..., 1] * x
      + 0.5 * f[..., 0]
  )  # end


expand_2d = [_expand_2d1p, _expand_2d2p, _expand_2d3p, _expand_2d4p]
